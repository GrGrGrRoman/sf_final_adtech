# Продвинутый Backend. Финальный проект #
## SF-Adtech ##

Приложение SF-AdTech — это трекер трафика, созданный для организации взаимодействия компаний (рекламодателей), которые хотят привлечь к себе на сайт посетителей и покупателей (клиентов), и владельцев сайтов (веб-мастеров), на которые люди приходят, например, чтобы почитать новости или пообщаться на форуме.
Рекламодатель создаёт предложение (offer), определяя URL страницы, на которую он хочет приводить людей. Например, это страница товара, который он хочет продавать. В offer-е он также определяет стоимость перехода по ссылке. Скажем, 1 рубль за переход.
Веб-мастера в системе видят создаваемые офферы, подписываются на них, после чего система выдаёт им специальные ссылки, которые они должны разместить в любом виде у себя на ресурсе. Ссылка эта ведёт не на целевой URL, а на систему-редиректор, которая фиксирует переход, а затем перенаправляет клиента на страницу сайта рекламодателя.
По итогам рекламодатель получает N посетителей и платит за это системе N рублей (согласно ставке в 1 рубль за переход).

Система позволяет авторизоваться и рекламодателем, и мастером под одним аккаунтом, т.е. мастер может рекламировать свои ссылки, а рекламодатель может подписаться на офферы других  рекламодателей - система начислений сведена в один счет.

Комиссия платформы 20% за переход. Если рекламодатель решит в качестве мастера продинуть свою ссылку, то он получит комиссию платформы в 25% и больше никаких списаний/начислений не будет.

Функционал редиректора обеспечивает весь цикл переходов и сбор статистики:
- получает информацию о ссылке, по которой кликнул клиент в момент перехода с сайта мастера
- фиксирует в таблице 'click' факт перехода, классы Model_Redirect, Controller_Redirect.
- преобразовывает клик-ссылку в целевой URL и перенаправляет клиента
- проверяет подписку мастера

## Интерфейсы

На платформе три интерфейса: администратор, рекламодатель и мастер.

### Администратор

Администратор управляет пользователями (активация, назначение администратора, редактор профиля). Администратор управляет офферами и просматривает статистику и бюджет в различных разрезах.

#### Статусы офферов:
0/1 - У рекламодателя не достаточно средств на балансе/Оффер отключен рекламодателем.\
2 - Оффер без подписок.\
3 - Рекламодатель заблокирован.\
4 - Мастер заблокирован.\
5 - На оффер подписаны, ссылка ОК, деньги перечисляются.

### Рекламодатель

Рекламодатель может зарегистрироваться и авторизоваться в системе, создать оффер (имя, стоимость, тема, url), деактивировать или удалить оффер, посмотреть мастеров-подписчиков, посмотреть расходи и количество переходов в разрезе день/месяц/год.

### Мастер

Мастер может зарегистрироваться и авторизоваться в системе, посмотреть список своих подписок, подписаться/отписаться, посмотерть статистику по офферу в разрезе доходы и периоды день/месяц/год.

## Функции, реализованные на платформе

- Авторизация и регистрация, выбор роли.
- Запись и просмотр статистики переходов и отказов по ссылкам
- Поиск по созданным ифферам и вывод всех офферов платформы.
- Полный контроль администратора над пользователями и офферами.
- Защита от sql-инъекций, CSRF и XSS атак;
- В базе данных расставлены индексы.
- Система работает в многопользовательском режиме

Приложение выполено в соответствии с концепцией ООП MVC, тип БД MySQL, ORM RedBeanPHP, автозагрузка библиотек и классов через composer. Пример БД adtech.sql экспортирован в корневой каталог приложения.

## Запуск

Для работы приложения необходим PHP, composer, MySQL. Настройки подключения к базе данных adtech в app/core/Model.php
